---
title: "whr-website"
execute:
  echo: false
  warning: false
  message: false
---

```{r}
#| label: setup
library(tidyverse)
library(quarto)
library(brand.yml)

whr <- read_csv(here::here("data/whr.csv"))

brand <- read_brand_yml("_brand.yml")

theme_whr <-
  theme_brand_ggplot2("_brand.yml") +
  theme(
    plot.title = element_text(size = 14, face = "bold"),
    plot.subtitle = element_text(size = 12)
  ) 
```

```{r}
#| label: global-trends
global_trends <- 
  whr |>
  group_by(year) |>
  summarise(
    mean_happiness = mean(ladder_score, na.rm = TRUE),
    median_happiness = median(ladder_score, na.rm = TRUE),
    min_happiness = min(ladder_score, na.rm = TRUE),
    max_happiness = max(ladder_score, na.rm = TRUE),
    countries_count = n(),
    .groups = 'drop'
  )
global_trends |> 
  ggplot(aes(x = year, y = mean_happiness)) +
  geom_line(color = brand$color$palette$teal, linewidth = 1.5) +
  geom_point(color = brand$color$palette$teal, size = 3) +
  labs(
    title = "Global Average Happiness Over Time (2011-2024)",
    subtitle = "Average happiness has increased over the past 12 years",
    x = "Year",
    y = "Average Happiness Score"
  ) +
  scale_x_continuous(breaks = seq(2011, 2024, 1)) +
  scale_y_continuous(limits = c(5.2, 5.7), breaks = seq(5.2, 5.7, 0.1)) +
  theme_whr +
  theme(
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  ) 
```